'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var serverRuntime = require('@remix-run/server-runtime');

function validateShopAndHostParams(params, request) {
  const {
    api,
    config,
    logger
  } = params;
  if (config.isEmbeddedApp) {
    const url = new URL(request.url);
    const shop = api.utils.sanitizeShop(url.searchParams.get('shop'));
    if (!shop) {
      logger.debug('Missing or invalid shop, redirecting to login path', {
        shop
      });
      throw serverRuntime.redirect(config.auth.loginPath);
    }
    const host = api.utils.sanitizeHost(url.searchParams.get('host'));
    if (!host) {
      logger.debug('Invalid host, redirecting to login path', {
        host: url.searchParams.get('host')
      });
      throw serverRuntime.redirect(config.auth.loginPath);
    }
  }
}

exports.validateShopAndHostParams = validateShopAndHostParams;
