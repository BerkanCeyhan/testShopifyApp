"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ensureAppIsEmbeddedIfRequired = void 0;
var tslib_1 = require("tslib");
var redirect_to_shopify_or_app_root_1 = require("./redirect-to-shopify-or-app-root");
var ensureAppIsEmbeddedIfRequired = function (params, request) { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
    var api, logger, config, url, shop;
    return tslib_1.__generator(this, function (_a) {
        switch (_a.label) {
            case 0:
                api = params.api, logger = params.logger, config = params.config;
                url = new URL(request.url);
                shop = url.searchParams.get('shop');
                if (!(api.config.isEmbeddedApp && url.searchParams.get('embedded') !== '1')) return [3 /*break*/, 2];
                logger.debug('App is not embedded, redirecting to Shopify', { shop: shop });
                return [4 /*yield*/, (0, redirect_to_shopify_or_app_root_1.redirectToShopifyOrAppRoot)(request, { api: api, logger: logger, config: config })];
            case 1:
                _a.sent();
                _a.label = 2;
            case 2: return [2 /*return*/];
        }
    });
}); };
exports.ensureAppIsEmbeddedIfRequired = ensureAppIsEmbeddedIfRequired;
//# sourceMappingURL=ensure-app-is-embedded-if-required.js.map