"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ensureCORSHeadersFactory = void 0;
var tslib_1 = require("tslib");
var const_1 = require("../const");
function ensureCORSHeadersFactory(params, request, corsHeaders) {
    if (corsHeaders === void 0) { corsHeaders = []; }
    var logger = params.logger, config = params.config;
    return function ensureCORSHeaders(response) {
        var origin = request.headers.get('Origin');
        if (origin && origin !== config.appUrl) {
            logger.debug('Request comes from a different origin, adding CORS headers');
            var corsHeadersSet = new Set(tslib_1.__spreadArray([
                'Authorization',
                'Content-Type'
            ], tslib_1.__read(corsHeaders), false));
            response.headers.set('Access-Control-Allow-Origin', '*');
            response.headers.set('Access-Control-Allow-Headers', tslib_1.__spreadArray([], tslib_1.__read(corsHeadersSet), false).join(', '));
            response.headers.set('Access-Control-Expose-Headers', const_1.REAUTH_URL_HEADER);
        }
        return response;
    };
}
exports.ensureCORSHeadersFactory = ensureCORSHeadersFactory;
//# sourceMappingURL=ensure-cors-headers.js.map